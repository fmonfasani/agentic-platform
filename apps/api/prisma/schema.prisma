// ===================================================
// Prisma Schema â€” platform_agents (by fmonfasani)
// ===================================================

generator client {
  provider = "prisma-client-js"
}
datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// ===================================================
// MODELS
// ===================================================

model Agent {
  id            String   @id @default(uuid())
  name          String
  area          String
  description   String?
  uses          Int      @default(0)
  downloads     Int      @default(0)
  rewards       Int      @default(0)
  stars         Float    @default(0)
  votes         Int      @default(0)
  openaiAgentId String?
  model         String?  @default("gpt-4.1-mini")
  instructions  String?
  updatedAt     DateTime @updatedAt

  traces    AgentTrace[]
  workflows Workflow[]
}

model AgentTrace {
  id        String   @id @default(uuid())
  agentId   String
  runId     String
  status    String
  grade     Float?
  evaluator String?
  feedback  String?
  traceUrl  String?
  input     String?
  output    String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  agent Agent @relation(fields: [agentId], references: [id], onDelete: Cascade)
}

model Workflow {
  id        String   @id @default(uuid())
  name      String
  status    String   @default("ready")
  model     String   @default("gpt-4o")
  platform  String   @default("OpenAI")
  agentId   String
  agent     Agent    @relation(fields: [agentId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
}
