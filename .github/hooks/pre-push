#!/usr/bin/env bash
# ü©∫ Pre-push hook: ejecuta diagn√≥stico iopeer antes de subir cambios
set -e

echo "üîç Ejecutando diagn√≥stico iopeer antes del push..."
PROJECT_ROOT="$(git rev-parse --show-toplevel)"
cd "$PROJECT_ROOT"

# Usa Python del sistema (compatible con Windows Git Bash)
python diagnose_iopeer.py
STATUS=$?

if [ $STATUS -ne 0 ]; then
  echo "‚ùå Diagn√≥stico fallido. Corrige los errores antes de hacer push."
  exit 1
else
  echo "‚úÖ Diagn√≥stico OK. Continuando con el push..."
fi
